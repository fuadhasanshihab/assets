<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Directory Listing</title>
    <style>
        body { font-family: Arial, sans-serif; }
        ul { list-style-type: none; padding: 0; }
        li { margin: 5px 0; }
        a { text-decoration: none; color: #0366d6; }
        a:hover { text-decoration: underline; }
        .dropdown-content { display: none; margin-left: 20px; }
        .dropdown-button { cursor: pointer; }
        .dropdown-button:after { content: " ▼"; }
        .dropdown-button.open:after { content: " ▲"; }
    </style>
</head>
<body>
    <h1>Directory Listing</h1>
    <ul id="file-list"></ul>

    <script>
        const repo = 'assets'; // Your repository name
        const owner = 'fuadhasanshihab'; // Your GitHub username
        const branch = 'main'; // Your branch name
        let currentPath = ''; // To keep track of the current directory

        async function fetchFiles(path = '') {
            try {
                const url = `https://api.github.com/repos/${owner}/${repo}/contents/${path}?ref=${branch}`;
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();

                return data;
            } catch (error) {
                console.error('Failed to fetch files:', error);
                return [];
            }
        }

        async function displayFiles(path = '') {
            const fileList = document.getElementById('file-list');
            const data = await fetchFiles(path);
            fileList.innerHTML = '';

            data.forEach(file => {
                const listItem = document.createElement('li');
                if (file.type === 'dir') {
                    const dropdownButton = document.createElement('div');
                    dropdownButton.className = 'dropdown-button';
                    dropdownButton.innerHTML = `${file.name}`;

                    const dropdownContent = document.createElement('ul');
                    dropdownContent.className = 'dropdown-content';

                    dropdownButton.onclick = async () => {
                        dropdownButton.classList.toggle('open');
                        dropdownContent.style.display = dropdownContent.style.display === 'none' ? 'block' : 'none';
                        if (!dropdownContent.hasChildNodes()) {
                            const subFiles = await fetchFiles(file.path);
                            subFiles.forEach(subFile => {
                                const subListItem = document.createElement('li');
                                if (subFile.type === 'dir') {
                                    subListItem.innerHTML = `<div class="dropdown-button">${subFile.name}</div><ul class="dropdown-content"></ul>`;
                                    const subDropdownButton = subListItem.querySelector('.dropdown-button');
                                    const subDropdownContent = subListItem.querySelector('.dropdown-content');
                                    subDropdownButton.onclick = async () => {
                                        subDropdownButton.classList.toggle('open');
                                        subDropdownContent.style.display = subDropdownContent.style.display === 'none' ? 'block' : 'none';
                                        if (!subDropdownContent.hasChildNodes()) {
                                            const nestedFiles = await fetchFiles(subFile.path);
                                            nestedFiles.forEach(nestedFile => {
                                                const nestedListItem = document.createElement('li');
                                                if (nestedFile.type === 'dir') {
                                                    nestedListItem.innerHTML = `<div class="dropdown-button">${nestedFile.name}</div><ul class="dropdown-content"></ul>`;
                                                    const nestedDropdownButton = nestedListItem.querySelector('.dropdown-button');
                                                    const nestedDropdownContent = nestedListItem.querySelector('.dropdown-content');
                                                    nestedDropdownButton.onclick = async () => {
                                                        nestedDropdownButton.classList.toggle('open');
                                                        nestedDropdownContent.style.display = nestedDropdownContent.style.display === 'none' ? 'block' : 'none';
                                                        if (!nestedDropdownContent.hasChildNodes()) {
                                                            const moreNestedFiles = await fetchFiles(nestedFile.path);
                                                            moreNestedFiles.forEach(moreNestedFile => {
                                                                const moreNestedListItem = document.createElement('li');
                                                                moreNestedListItem.innerHTML = moreNestedFile.type === 'dir' ?
                                                                    `<div class="dropdown-button">${moreNestedFile.name}</div><ul class="dropdown-content"></ul>` :
                                                                    `<a href="${moreNestedFile.path}">${moreNestedFile.name}</a>`;
                                                                nestedDropdownContent.appendChild(moreNestedListItem);
                                                            });
                                                        }
                                                    };
                                                    nestedDropdownContent.style.display = 'none';
                                                } else {
                                                    nestedListItem.innerHTML = `<a href="${nestedFile.path}">${nestedFile.name}</a>`;
                                                }
                                                subDropdownContent.appendChild(nestedListItem);
                                            });
                                        }
                                    };
                                    subDropdownContent.style.display = 'none';
                                } else {
                                    subListItem.innerHTML = `<a href="${subFile.path}">${subFile.name}</a>`;
                                }
                                dropdownContent.appendChild(subListItem);
                            });
                        }
                    };

                    dropdownContent.style.display = 'none';
                    listItem.appendChild(dropdownButton);
                    listItem.appendChild(dropdownContent);
                } else {
                    listItem.innerHTML = `<a href="${file.path}">${file.name}</a>`;
                }
                fileList.appendChild(listItem);
            });
        }

        // Initial load
        displayFiles();
    </script>
</body>
</html>
